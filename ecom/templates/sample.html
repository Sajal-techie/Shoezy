<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Cropping</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css">
</head>
<body>

<input type="file" id="image-input" accept="image/*">
<div>
    <img id="cropped-image" style="max-width: 100%;">
</div>
<button id="crop-button">Crop Image</button>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>

<script>
    $(document).ready(function () {
        const input = document.getElementById('image-input');
        const image = document.getElementById('cropped-image');
        let cropper;

        input.addEventListener('change', function (e) {
            const file = e.target.files[0];
            const reader = new FileReader();

            reader.onload = function (event) {
                image.src = event.target.result;
                cropper = new Cropper(image, {
                    aspectRatio: 1, // Set the aspect ratio for cropping as needed
                    viewMode: 2, // Set the view mode (e.g., 0, 1, 2, 3)
                    // Other options can be added as needed
                });
            };

            reader.readAsDataURL(file);
        });

        $('#crop-button').on('click', function () {
            if (cropper) {
                const canvas = cropper.getCroppedCanvas();
                const croppedImageData = canvas.toDataURL(); // Get cropped image data as base64 string

                // Send cropped image data to the server
                $.ajax({
                    type: 'POST',
                    url: '/save-cropped-image', // Replace with your server endpoint
                    data: { image: croppedImageData },
                    success: function (response) {
                        console.log('Image saved successfully:', response);
                        // You can handle the response from the server as needed
                    },
                    error: function (error) {
                        console.error('Error saving image:', error);
                    }
                });
            } else {
                console.error('Cropper not initialized or no image selected.');
            }
        });
    });
</script>

</body>
</html>
